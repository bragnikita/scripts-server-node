server {
        listen 80;
        server_name {{server_name}} "";

        access_log  /var/www/{{ app_name }}/shared/logs/nginx-access.log  main;
        error_log  /var/www/{{ app_name }}/shared/logs/nginx-error.log;

        location / {
            root /var/www/{{ app_name }}/current/public;
            try_files $uri @api;
        }
        location @api {
                proxy_pass http://localhost:{{app_port}};
                proxy_set_header X-Real-IP  $remote_addr;
                proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
                proxy_set_header Host $http_host;
                proxy_redirect off;
                proxy_next_upstream error timeout invalid_header http_502;
        }
        client_max_body_size 4G;
        keepalive_timeout 10;
}
